{"ast":null,"code":"import _objectSpread from\"/home/gaurav/Downloads/ITCC-System-master/frontend/node_modules/.pnpm/@babel+runtime@7.27.1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{Container,Form,Button}from'react-bootstrap';import axios from'axios';import{toast}from'react-hot-toast';import'./queryDetails.style.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const QueryDetails=()=>{var _ticket$employeeId,_ticket$employeeId2,_ticket$employeeId3;const{id}=useParams();const navigate=useNavigate();const[ticket,setTicket]=useState(null);const[comment,setComment]=useState('');useEffect(()=>{console.log('Fetching ticket details for ID:',id);// Debug log\naxios.get(\"/api/tickets/\".concat(id)).then(response=>{console.log('Ticket details fetched successfully:',response.data);// Debug log\nsetTicket(response.data);setComment(response.data.adminComment||'');}).catch(error=>{console.error('Error fetching ticket details:',error);});},[id]);const handleCloseTicket=()=>{axios.put(\"/api/tickets/\".concat(id,\"/close\")).then(()=>{toast.success('Ticket has been closed successfully.',{duration:5000});setTicket(_objectSpread(_objectSpread({},ticket),{},{status:'Closed'}));}).catch(error=>{console.error('Error closing the ticket:',error);toast.error('Failed to close the ticket.',{duration:5000});});};const handleSaveComment=()=>{axios.put(\"/api/tickets/\".concat(id,\"/comment\"),{adminComment:comment}).then(()=>{toast.success('Comment saved successfully.',{duration:5000});}).catch(error=>{console.error('Error saving comment:',error);toast.error('Failed to save comment.',{duration:5000});});};return/*#__PURE__*/_jsxs(Container,{className:\"query-details-page\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"query-details-header\",children:\"Query Details\"}),ticket?/*#__PURE__*/_jsxs(\"div\",{className:\"query-details-section\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",ticket.createdAt?new Date(ticket.createdAt).toLocaleDateString('en-GB'):'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Time:\"}),\" \",ticket.createdAt?new Date(ticket.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit',hour12:true}):'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",((_ticket$employeeId=ticket.employeeId)===null||_ticket$employeeId===void 0?void 0:_ticket$employeeId.name)||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Department:\"}),\" \",((_ticket$employeeId2=ticket.employeeId)===null||_ticket$employeeId2===void 0?void 0:_ticket$employeeId2.department)||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Designation:\"}),\" \",((_ticket$employeeId3=ticket.employeeId)===null||_ticket$employeeId3===void 0?void 0:_ticket$employeeId3.designation)||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Criticality:\"}),\" \",ticket.priority||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Type:\"}),\" \",ticket.issueType||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Description:\"}),\" \",ticket.description||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",ticket.status||'N/A']})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading ticket details...\"}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"adminComment\",className:\"query-details-form\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Admin Comment\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,value:comment,onChange:e=>setComment(e.target.value),placeholder:\"Write your comment here...\"})]}),/*#__PURE__*/_jsx(Button,{className:\"query-details-button\",onClick:handleSaveComment,children:\"Save Comment\"}),/*#__PURE__*/_jsx(Button,{className:\"query-details-button\",onClick:handleCloseTicket,children:\"Close Ticket\"}),/*#__PURE__*/_jsx(Button,{className:\"query-details-button\",onClick:()=>navigate('/admin'),children:\"Back to Admin\"})]});};export default QueryDetails;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","Container","Form","Button","axios","toast","jsx","_jsx","jsxs","_jsxs","QueryDetails","_ticket$employeeId","_ticket$employeeId2","_ticket$employeeId3","id","navigate","ticket","setTicket","comment","setComment","console","log","get","concat","then","response","data","adminComment","catch","error","handleCloseTicket","put","success","duration","_objectSpread","status","handleSaveComment","className","children","createdAt","Date","toLocaleDateString","toLocaleTimeString","hour","minute","hour12","employeeId","name","department","designation","priority","issueType","description","Group","controlId","Label","Control","as","rows","value","onChange","e","target","placeholder","onClick"],"sources":["/home/gaurav/Downloads/ITCC-System-master/frontend/src/pages/admin/queryDetails.page.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Container, Form, Button } from 'react-bootstrap';\nimport axios from 'axios';\nimport { toast } from 'react-hot-toast';\nimport './queryDetails.style.css';\n\nconst QueryDetails = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [ticket, setTicket] = useState(null);\n  const [comment, setComment] = useState('');\n\n  useEffect(() => {\n    console.log('Fetching ticket details for ID:', id); // Debug log\n    axios.get(`/api/tickets/${id}`)\n      .then(response => {\n        console.log('Ticket details fetched successfully:', response.data); // Debug log\n        setTicket(response.data);\n        setComment(response.data.adminComment || '');\n      })\n      .catch(error => {\n        console.error('Error fetching ticket details:', error);\n      });\n  }, [id]);\n\n  const handleCloseTicket = () => {\n    axios.put(`/api/tickets/${id}/close`)\n      .then(() => {\n        toast.success('Ticket has been closed successfully.', { duration: 5000 });\n        setTicket({ ...ticket, status: 'Closed' });\n      })\n      .catch(error => {\n        console.error('Error closing the ticket:', error);\n        toast.error('Failed to close the ticket.', { duration: 5000 });\n      });\n  };\n\n  const handleSaveComment = () => {\n    axios.put(`/api/tickets/${id}/comment`, { adminComment: comment })\n      .then(() => {\n        toast.success('Comment saved successfully.', { duration: 5000 });\n      })\n      .catch(error => {\n        console.error('Error saving comment:', error);\n        toast.error('Failed to save comment.', { duration: 5000 });\n      });\n  };\n\n  return (\n    <Container className=\"query-details-page\">\n      <h1 className=\"query-details-header\">Query Details</h1>\n      {ticket ? (\n        <div className=\"query-details-section\">\n          <p><strong>Date:</strong> {ticket.createdAt ? new Date(ticket.createdAt).toLocaleDateString('en-GB') : 'N/A'}</p>\n          <p><strong>Time:</strong> {ticket.createdAt ? new Date(ticket.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true }) : 'N/A'}</p>\n          <p><strong>Name:</strong> {ticket.employeeId?.name || 'N/A'}</p>\n          <p><strong>Department:</strong> {ticket.employeeId?.department || 'N/A'}</p>\n          <p><strong>Designation:</strong> {ticket.employeeId?.designation || 'N/A'}</p>\n          <p><strong>Criticality:</strong> {ticket.priority || 'N/A'}</p>\n          <p><strong>Type:</strong> {ticket.issueType || 'N/A'}</p>\n          <p><strong>Description:</strong> {ticket.description || 'N/A'}</p>\n          <p><strong>Status:</strong> {ticket.status || 'N/A'}</p>\n        </div>\n      ) : (\n        <p>Loading ticket details...</p>\n      )}\n      <Form.Group controlId=\"adminComment\" className=\"query-details-form\">\n        <Form.Label>Admin Comment</Form.Label>\n        <Form.Control\n          as=\"textarea\"\n          rows={3}\n          value={comment}\n          onChange={(e) => setComment(e.target.value)}\n          placeholder=\"Write your comment here...\"\n        />\n      </Form.Group>\n      <Button className=\"query-details-button\" onClick={handleSaveComment}>\n        Save Comment\n      </Button>\n      <Button className=\"query-details-button\" onClick={handleCloseTicket}>\n        Close Ticket\n      </Button>\n      <Button className=\"query-details-button\" onClick={() => navigate('/admin')}>\n        Back to Admin\n      </Button>\n    </Container>\n  );\n};\n\nexport default QueryDetails;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}